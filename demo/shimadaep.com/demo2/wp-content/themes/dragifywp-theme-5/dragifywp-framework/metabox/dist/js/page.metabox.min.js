!function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};t.m=e,t.c=o,t.p="",t(0)}([function(e,exports,t){"use strict";t(1),function(e){var t=e.module("dragifywp.page.metabox",["colorpicker.module"]);t.__config={enableDebug:!1},"undefined"!=typeof dragifywp_mb_data&&(t.__config=e.merge(t.__config,dragifywp_mb_data)),t.controller("dragifywp.page.metabox.controller",function(){}).config(["$provide","$httpProvider",function(e,o){e.factory("lbHttpInterceptor",["$q","$rootScope",function(e,o){return{request:function(o){return o.headers["X-WP-Nonce"]=t.__config.nonce,o||e.when(o)},responseError:function(t){return void 0!==t.data&&"rest_cookie_invalid_nonce"==t.data.code&&o.$emit("expired_session"),e.reject(t)}}}]),o.interceptors.push("lbHttpInterceptor")}]),t.config(["$compileProvider",function(e){e.debugInfoEnabled(t.__config.enableDebug)}]),t.component("pageMetabox",{controller:["$rootScope",function(e){this.model=t.__config.settings,this.setting={current_tab:1,tabs:[{id:1,name:"Layout"},{id:2,name:"Additional Content"}],get_current:function(){return this.current_tab},is_current:function(e){return e==this.current_tab},set_current:function(e){this.current_tab=e}},e.$on("expired_session",function(){document.location.replace(t.__config.login_url)})}],template:'<input type="hidden" id="dragifywp-settings" name="dragifywp-settings" value="{{$ctrl.model}}"/><div class="dragifywp-mb__container"><mb-header model="$ctrl.model"></mb-header><mb-body model="$ctrl.model" setting="$ctrl.setting"></mb-body></div>'}),t.component("mbHeader",{controller:["$timeout","$http",function(e,o){var i=this;this.state="disabled";var n=JSON.stringify(this.model);this.save=function(r){r.preventDefault(),"ready"==i.state&&(i.state="saving",o({method:"POST",url:t.__config.api+"/settings",data:{id:t.__config.post_id,settings:JSON.stringify(i.model)}}).then(function(t){-1!=t.data?(i.state="saved",e(function(){n=JSON.stringify(i.model),i.state="disabled"},1e3)):(alert("Error in saving data"),i.state="ready")},function(e){alert("Error in saving data"),i.state="ready"}))},i.getState=function(){return"disabled"==i.state&&JSON.stringify(i.model)!==n&&(i.state="ready"),i.state}}],template:'<div class="dragifywp-mb__header"><h6 class="dragifywp-mb__header__title">Settings</h6><button class="dragifywp-mb__saveBtn dragifywp-ui__btn dragifywp-ui__btn--primary" ng-class="\'dragifywp-mb__saveBtn--\'+$ctrl.getState()" ng-click="$ctrl.save($event)"><span>Saved</span><span>Save</span><span></span><span><i class="fa fa-check" aria-hidden="true"></i></span></button></div>',bindings:{model:"<"}}),t.component("mbBody",{controller:function(){},template:'<div class="dragifywp-mb__body"><mb-menu on-select="$ctrl.setting.set_current(id)" tabs="$ctrl.setting.tabs" current-tab="$ctrl.setting.current_tab"></mb-menu><mb-panel current-tab="$ctrl.setting.current_tab" model="$ctrl.model"></mb-panel></div>',bindings:{model:"=",setting:"<",current:"<"}}),t.component("mbMenu",{controller:function(){},template:'<div class="dragifywp-mb__menu"><ul><li class="dragifywp-mb__menu__item"ng-class="{\'dragifywp-mb__menu__item--active\':$ctrl.currentTab == item.id}"ng-click="$ctrl.onSelect(item)"ng-repeat="item in ::$ctrl.tabs" ng-bind="::item.name"></li></ul></div>',bindings:{onSelect:"&",tabs:"<",currentTab:"<"}}),t.component("mbPanel",{controller:function(){},template:'<div class="dragifywp-mb__panelContainer"><mb-layout-panel ng-if="$ctrl.currentTab == 1" model="$ctrl.model.layout"></mb-layout-panel><mb-addition-panel ng-if="$ctrl.currentTab == 2" model="$ctrl.model.addition"></mb-addition-panel></div>',bindings:{currentTab:"<",model:"="}}),t.component("mbLayoutPanel",{controller:function(){this.layouts=["blank","fullwidth","sidebar-left","sidebar-right"],this.selectLayout=function(e){this.model.type=e},this.sidebars=t.__config.sidebars||{},this.validSidebar=function(){return"sidebar-left"==this.model.type||"sidebar-right"==this.model.type}},template:'<div class="dragifywp-mb__panel"><div class="dragifywp-mb__section"><h3 class="dragifywp-mb__section__name">Display Feature Image</h3><p class="dragifywp-mb__section__desc">Activate this button to display a hero banner containing the feature image of this page.</p><dragifywp-ed-switch model="$ctrl.model.feature_image"></dragifywp-ed-switch></div><div class="dragifywp-mb__section dragifywp-mb__section--noVPadding"><div class="dragifywp-mb__section--1-2" ><h3 class="dragifywp-mb__section__name">Layout</h3><p class="dragifywp-mb__section__desc">Select a layout to present this page. It depends on you to choose whether to include sidebar in the layout or not.</p><ul class="dragifywp-ui__layout"><li class="dragifywp-ui__layout__item" ng-repeat="layout in ::$ctrl.layouts"ng-class="{\'dragifywp-ui__layout__item--selected\':$ctrl.model.type == layout}"ng-click="$ctrl.selectLayout(layout)"><img ng-src="'+t.__config.img_dir+'/layouts/{{::layout}}.png"></li></ul></div><div class="dragifywp-mb__section--1-2" ng-class="{\'dragifywp-mb__block--disabled\':!$ctrl.validSidebar()}"><h3 class="dragifywp-mb__section__name">Sidebar</h3><p class="dragifywp-mb__section__desc">This sidebar will be displayed if you choose page with right or left sidebar layout.</p><div list-selection ng-model="$ctrl.model.sidebar" ng-list="$ctrl.sidebars" ng-default="{id:0, name:\'Select a Sidebar\'}"></div></div></div><div class="dragifywp-mb__section"><h3 class="dragifywp-mb__section__name">Breadcrumb</h3><p class="dragifywp-mb__section__desc">Activate this button to display a breadcrumb for this page. It allows users to keep track of their locations from this page.</p><dragifywp-ed-switch model="$ctrl.model.breadcrumb"></dragifywp-ed-switch></div></div>',bindings:{model:"="}}),t.component("mbAdditionPanel",{controller:function(){},template:'<div class="dragifywp-mb__panel"><div class="dragifywp-mb__section"><h3 class="dragifywp-mb__section__name">Before</h3><p class="dragifywp-mb__section__desc">Add additional content before the page layout. Shortcodes and html are accepted.</p><textarea class="dragifywp-ui__textarea" type="text" ng-model="$ctrl.model.before" rows="5" cols="20" ng-model-options="{debounce:500}"/></div><div class="dragifywp-mb__section"><h3 class="dragifywp-mb__section__name">After</h3><p class="dragifywp-mb__section__desc">Add additional content after the page layout. Shortcodes and html are accepted.</p><textarea class="dragifywp-ui__textarea" type="text" ng-model="$ctrl.model.after" rows="5" cols="20" ng-model-options="{debounce:500}"/></div></div>',bindings:{model:"="}});var o=0;t.component("dragifywpEdSwitch",{controller:function(){this.id="lbswid-"+ ++o},template:'<div class="dragifywp-ui__switch"><input class="dragifywp-ui__switch__checkbox" type="checkbox" ng-model="$ctrl.model" id="{{::$ctrl.id}}"/><label class="dragifywp-ui__switch__btn" for="{{::$ctrl.id}}"><span class="dragifywp-ui__switch__btn__toggle"></span></label></div>',bindings:{model:"="}}),t.component("dragifywpEdWordCounter",{controller:function(){},template:'<div class="dragifywp-ui__wordCounter"><input class="dragifywp-ui__wordCounter__input dragifywp-ui__inputText" type="text" maxlength="{{::$ctrl.maxLength}}" placeholder="{{::$ctrl.placeholder}}" ng-model="$ctrl.model"/><div class="dragifywp-ui__wordCounter__counter"><span ng-bind="$ctrl.model.length+\'/\'+$ctrl.maxLength"></span></div></div>',bindings:{model:"=",maxLength:"@",placeholder:"@"}}),t.component("dragifywpEdHeroImage",{controller:["$scope",function(e){var t,o,i=this;this.upload=function(){t=wp.media({title:"Upload or Choose from Media Library",button:{text:"Select Image"},multiple:!1}),t.on("select",function(){o=t.state().get("selection").first().toJSON(),e.$apply(function(){i.model.id=o.id,i.model.url=o.url})}),t.open()},this.remove=function(){this.model.id="",this.model.url=""}}],template:'<div class="dragifywp-ui__heroImage"><div class="dragifywp-ui__heroImage__header"><span class="dragifywp-ui__btn dragifywp-ui__btn--remove dragifywp-ui--marginRight3" ng-click="$ctrl.remove()" ng-show="$ctrl.model.url"><span class="fa fa-trash"></span> Remove</span><span class="dragifywp-ui__btn dragifywp-ui__btn--plain" ng-click="$ctrl.upload()"><span class="fa fa-upload"></span> Upload</span></div><div class="dragifywp-ui__heroImage__body"ng-class="{\'dragifywp-ui__heroImage__body--hasImage\':$ctrl.model.url }"ng-style="{\'background-image\':\'url(\'+$ctrl.model.url+\')\',\'background-position\':$ctrl.model.bg_position}"><div drag-position="$ctrl.model.bg_position" ng-if="$ctrl.model.url"></div><div class="dragifywp-ui__heroImage__content"><h4 class="dragifywp-ui__heroImage__title" ng-if="$ctrl.model.title" ng-bind="$ctrl.model.title" ng-style="{\'color\':$ctrl.model.title_color}"></h4><p class="dragifywp-ui__heroImage__desc" ng-if="$ctrl.model.desc" ng-bind="$ctrl.model.desc" ng-style="{\'color\':$ctrl.model.desc_color}"></p></div><div class="dragifywp-ui__heroImage__overlay" ng-style="{\'background\':\'linear-gradient(\'+$ctrl.model.overlay_top+\',\'+ $ctrl.model.overlay_bottom +\' )\'}"></div></div></div>',bindings:{model:"="}}),t.directive("listSelection",function(){return{restrict:"A",scope:{ngModel:"=",ngList:"=",ngDefault:"="},link:function(t,o,i){var n=Date.now(),r=jQuery('<select id="uq-'+n+'" style="width: 100%"></select>');if(e.isObject(t.ngDefault)&&r.append('<option value="'+t.ngDefault.id+'">'+t.ngDefault.name+"</option>"),e.isArray(t.ngList)){var a=!0,l=!1,s=void 0;try{for(var c,d=t.ngList[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var p=c.value,u=p.id==t.ngModel?'selected="selected"':"";r.append('<option value="'+p.id+'" '+u+">"+p.name+"</option>")}}catch(e){l=!0,s=e}finally{try{!a&&d.return&&d.return()}finally{if(l)throw s}}}else if(e.isObject(t.ngList)){var f=!0,g=!1,m=void 0;try{for(var _,b=Object.keys(t.ngList)[Symbol.iterator]();!(f=(_=b.next()).done);f=!0){var h=_.value,y=t.ngList[h],v=y.id==t.ngModel?'selected="selected"':"";r.append('<option value="'+h+'" '+v+">"+y.name+"</option>")}}catch(e){g=!0,m=e}finally{try{!f&&b.return&&b.return()}finally{if(g)throw m}}}o.append(r),r.select2();var w=!1;r.on("change",function(){if(w)return void(w=!1);t.$apply(function(){t.ngModel=r.val()})}),t.$watch("ngModel",function(){w=!0,r.val(t.ngModel).trigger("change")})}}}),t.directive("dragPosition",["$document",function(t){return{restrict:"A",scope:{dragPosition:"="},link:function(o,i,n){function r(e){u=e.pageY-d,p=e.pageX-c;var t=i.height(),n=i.width();u<0?(u=0,s=0):u>t?(u=t,s=100):s=100*u/t,p<0?(p=0,l=0):p>n?(p=n,l=100):l=100*p/n,f.css({top:u+"px",left:p+"px"}),o.$apply(function(){o.dragPosition=l.toFixed(2)+"% "+s.toFixed(2)+"%"})}function a(){t.off("mousemove",r),t.off("mouseup",a)}i.addClass("dragifywp-ui__dragPoint");var l,s,c=0,d=0,p=0,u=0;o.dragPosition||(o.dragPosition="50% 50%"),u=o.dragPosition.split(" ")[0],p=o.dragPosition.split(" ")[1],u=parseFloat(u.substring(0,u.length-1))*i.height()/100,p=parseFloat(p.substring(0,p.length-1))*i.width()/100;var f=e.element("<span></span>");f.css({top:u+"px",left:p+"px"}),i.append(f),f.on("mousedown",function(e){e.preventDefault(),c=e.pageX-p,d=e.pageY-u,t.on("mousemove",r),t.on("mouseup",a)})}}}]),t.component("dragifywpEdColorpicker",{controller:function(){},template:'<div class="dragifywp-ui__colorpicker"><small ng-show="$ctrl.model != \'transparent\'" class="dragifywp-ui__colorpicker__transparentBtn" ng-click="$ctrl.model=\'transparent\'" title="Transparent"><i class="fa fa-genderless" aria-hidden="true"></i></small><input class="dragifywp-ui__colorpicker__input" ng-model="$ctrl.model" type="text"><span class="dragifywp-ui__colorpicker__picker" colorpicker="{{::$ctrl.format}}" colorpicker-position="bottom" ng-model="$ctrl.model" ng-model-options="{ debounce: 250 }"><i ng-style="{\'background-color\':$ctrl.model}"></i></span></div>',bindings:{model:"=",format:"@"}})}(window.angular)},function(e,exports){"use strict";angular.module("colorpicker.module",[]).factory("Helper",function(){return{closestSlider:function(e){return(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector).bind(e)("I")?e.parentNode:e},getOffset:function(e,t){for(var o=0,i=0,n=e.getBoundingClientRect();e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t||"BODY"!==e.tagName?(o+=e.scrollLeft,i+=e.scrollTop):(o+=document.documentElement.scrollLeft||e.scrollLeft,i+=document.documentElement.scrollTop||e.scrollTop),e=e.offsetParent;return{top:n.top+window.pageYOffset,left:n.left+window.pageXOffset,scrollX:o,scrollY:i}},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}]}}).factory("Color",["Helper",function(e){return{value:{h:1,s:1,b:1,a:1},rgb:function(){var e=this.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hex:function(){return this.toHex()},RGBtoHSB:function(e,t,o,i){e/=255,t/=255,o/=255;var n,r,a,l;return a=Math.max(e,t,o),l=a-Math.min(e,t,o),n=0===l?null:a===e?(t-o)/l:a===t?(o-e)/l+2:(e-t)/l+4,n=(n+360)%6*60/360,r=0===l?0:l/a,{h:n||1,s:r,b:a,a:i||1}},setColor:function(t){t=t?t.toLowerCase():t;for(var o in e.stringParsers)if(e.stringParsers.hasOwnProperty(o)){var i=e.stringParsers[o],n=i.re.exec(t),r=n&&i.parse(n);if(r)return this.value=this.RGBtoHSB.apply(null,r),!1}},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt(100*(1-e),10)/100},toRGB:function(e,t,o,i){e||(e=this.value.h,t=this.value.s,o=this.value.b),e*=360;var n,r,a,l,s;return e=e%360/60,s=o*t,l=s*(1-Math.abs(e%2-1)),n=r=a=o-s,e=~~e,n+=[s,l,0,0,l,s][e],r+=[l,s,s,l,0,0][e],a+=[0,0,l,s,s,l][e],{r:Math.round(255*n),g:Math.round(255*r),b:Math.round(255*a),a:i||this.value.a}},toHex:function(e,t,o,i){var n=this.toRGB(e,t,o,i);return"#"+(1<<24|parseInt(n.r,10)<<16|parseInt(n.g,10)<<8|parseInt(n.b,10)).toString(16).substr(1)}}}]).factory("Slider",["Helper",function(e){var t={maxLeft:0,maxTop:0,callLeft:null,callTop:null,knob:{top:0,left:0}},o={};return{getSlider:function(){return t},getLeftPosition:function(e){return Math.max(0,Math.min(t.maxLeft,t.left+((e.pageX||o.left)-o.left)))},getTopPosition:function(e){return Math.max(0,Math.min(t.maxTop,t.top+((e.pageY||o.top)-o.top)))},setSlider:function(i,n){var r=e.closestSlider(i.target),a=e.getOffset(r,n),l=r.getBoundingClientRect(),s=i.clientX-l.left,c=i.clientY-l.top;t.knob=r.children[0].style,t.left=i.pageX-a.left-window.pageXOffset+a.scrollX,t.top=i.pageY-a.top-window.pageYOffset+a.scrollY,o={left:i.pageX-(s-t.left),top:i.pageY-(c-t.top)}},setSaturation:function(e,o){t={maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},this.setSlider(e,o)},setHue:function(e,o){t={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},this.setSlider(e,o)},setAlpha:function(e,o){t={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"},this.setSlider(e,o)},setKnob:function(e,o){t.knob.top=e+"px",t.knob.left=o+"px"}}}]).directive("colorpicker",["$document","$compile","Color","Slider","Helper",function(e,t,o,i,n){return{require:"?ngModel",restrict:"A",link:function(r,a,l,s){function c(){e.on("mousemove",p),e.on("mouseup",u)}function d(){try{A.css("backgroundColor",T[v]())}catch(e){A.css("backgroundColor",T.toHex())}M.css("backgroundColor",T.toHex(T.value.h,1,1,1)),"rgba"===v&&(y.css.backgroundColor=T.toHex())}function p(e){var t=i.getLeftPosition(e),o=i.getTopPosition(e),n=i.getSlider();i.setKnob(o,t),n.callLeft&&T[n.callLeft].call(T,t/100),n.callTop&&T[n.callTop].call(T,o/100),d();var l=T[v]();return a.val(l),s&&r.$apply(s.$setViewValue(l)),I&&D.val(l),!1}function u(){b("colorpicker-selected"),e.off("mousemove",p),e.off("mouseup",u)}function f(e){T.setColor(a.val()),I&&!e&&D.val(a.val()),H.eq(0).css({left:100*T.value.s+"px",top:100-100*T.value.b+"px"}),H.eq(1).css("top",100*(1-T.value.h)+"px"),H.eq(2).css("top",100*(1-T.value.a)+"px"),d()}function g(){var e,t=n.getOffset(a[0]);return angular.isDefined(l.colorpickerParent)&&(t.left=0,t.top=0),"top"===w?e={top:t.top-147,left:t.left}:"right"===w?e={top:t.top,left:t.left+126}:"bottom"===w?e={top:t.top+a[0].offsetHeight+2,left:t.left}:"left"===w&&(e={top:t.top,left:t.left-150}),{top:e.top+"px",left:e.left+"px"}}function m(){h()}function _(){C.hasClass("colorpicker-visible")||(f(),C.addClass("colorpicker-visible").css(g()),b("colorpicker-shown"),!1===k&&e.on("mousedown",m),l.colorpickerIsOpen&&(r[l.colorpickerIsOpen]=!0,r.$$phase||r.$digest()))}function b(e){s&&r.$emit(e,{name:l.ngModel,value:s.$modelValue})}function h(){C.hasClass("colorpicker-visible")&&(C.removeClass("colorpicker-visible"),b("colorpicker-closed"),e.off("mousedown",m),l.colorpickerIsOpen&&(r[l.colorpickerIsOpen]=!1,r.$$phase||r.$digest()))}var y,v=l.colorpicker?l.colorpicker:"hex",w=angular.isDefined(l.colorpickerPosition)?l.colorpickerPosition:"bottom",k=!!angular.isDefined(l.colorpickerInline)&&l.colorpickerInline,x=!!angular.isDefined(l.colorpickerFixedPosition)&&l.colorpickerFixedPosition,S=angular.isDefined(l.colorpickerParent)?a.parent():angular.element(document.body),I=!!angular.isDefined(l.colorpickerWithInput)&&l.colorpickerWithInput,$=I?'<input type="text" name="colorpicker-input" spellcheck="false">':"",L=k?"":'<button type="button" class="close close-colorpicker">&times;</button>',P='<div class="colorpicker dropdown"><div class="dropdown-menu"><colorpicker-saturation><i></i></colorpicker-saturation><colorpicker-hue><i></i></colorpicker-hue><colorpicker-alpha><i></i></colorpicker-alpha><colorpicker-preview></colorpicker-preview>'+$+L+"</div></div>",C=angular.element(P),T=o,O=C.find("colorpicker-hue"),M=C.find("colorpicker-saturation"),A=C.find("colorpicker-preview"),H=C.find("i");if(t(C)(r),I){var D=C.find("input");D.on("mousedown",function(e){e.stopPropagation()}).on("keyup",function(){var e=this.value;a.val(e),s&&s.$modelValue!==e&&(r.$apply(s.$setViewValue(e)),f(!0))})}"rgba"===v&&(C.addClass("alpha"),y=C.find("colorpicker-alpha"),y.on("click",function(e){i.setAlpha(e,x),p(e)}).on("mousedown",function(e){i.setAlpha(e,x),c()}).on("mouseup",function(e){b("colorpicker-selected-alpha")})),O.on("click",function(e){i.setHue(e,x),p(e)}).on("mousedown",function(e){i.setHue(e,x),c()}).on("mouseup",function(e){b("colorpicker-selected-hue")}),M.on("click",function(e){i.setSaturation(e,x),p(e),angular.isDefined(l.colorpickerCloseOnSelect)&&h()}).on("mousedown",function(e){i.setSaturation(e,x),c()}).on("mouseup",function(e){b("colorpicker-selected-saturation")}),x&&C.addClass("colorpicker-fixed-position"),C.addClass("colorpicker-position-"+w),"true"===k&&C.addClass("colorpicker-inline"),S.append(C),s&&(s.$render=function(){a.val(s.$viewValue),f()}),a.on("blur keyup change",function(){f()}),a.on("$destroy",function(){C.remove()}),!1===k?a.on("click",_):_(),C.on("mousedown",function(e){e.stopPropagation(),e.preventDefault()}),C.find("button").on("click",function(){h()}),l.colorpickerIsOpen&&r.$watch(l.colorpickerIsOpen,function(e){!0===e?_():!1===e&&h()})}}}])}]);