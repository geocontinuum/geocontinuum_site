!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}({0:function(e,exports,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t(432),function(e){var t=window.dragifywp_app_header_data.label,i=t.charAt(0).toUpperCase()+t.substr(1),a=e.module("dragifywpPageHeaderApp",["dragifywpPopup"]);a.__config=window.dragifywp_app_header_data,a.controller("PageHeaderController",function(){}),a.config(["$provide","$httpProvider",function(e,t){e.factory("lbHttpInterceptor",["$q","$rootScope",function(e,t){return{request:function(t){return t.headers["X-WP-Nonce"]=a.__config.nonce,t||e.when(t)},responseError:function(n){return void 0!==n.data&&"rest_cookie_invalid_nonce"==n.data.code&&t.$emit("expired_session"),e.reject(n)}}}]),t.interceptors.push("lbHttpInterceptor")}]).config(["$compileProvider",function(e){e.debugInfoEnabled(a.__config.enable_debug)}]),a.component("pageHeaderMetabox",{controller:["$scope","$http","$DragifyWPPopup","$rootScope",function(i,o,s,r){var d=this,c={};c[t]="primary";var l={};if(d.items=[],void 0!=n(a.__config))try{l=a.__config.setting,d.items=a.__config.items}catch(e){}d.model=e.merge(c,l),this.syncing=!1,this.sync=function(){this.syncing=!0,o({method:"GET",url:a.__config.api+"/"+t+"s",data:{}}).then(function(t){e.isArray(t.data)&&(d.syncing=!1,d.items=t.data)},function(e){s.show({title:"Try it Later",message:"Cannot sync data now!"}),d.syncing=!1})},r.$on("expired_session",function(){document.location.replace(a.__config.login_url)})}],template:'<input type="hidden" name="dragifywp-page-'+t+'-setting" value="{{$ctrl.model}}" id="dragifywp-page-'+t+'-setting"><div class="dragifywp-smb"><mb-header model="$ctrl.model"></mb-header><div class="dragifywp-smb__body"><div class="dragifywp-smb__listSelection" ng-class="{\'dragifywp-smb__listSelection--syncing\':$ctrl.syncing}"><div class="dragifywp-smb__selection" list-selection ng-model="$ctrl.model[\''+t+"']\" ng-list=\"$ctrl.items\" ng-default=\"[{id:'none', name:'No "+i+"'},{id:'primary', name:'Use Primary "+i+'\', selected:\'selected\'}]"></div><span ng-click="$ctrl.sync()" class="dragifywp-smb__syncBtn dashicons dashicons-update" title="Sync data"></span></div></div><mb-footer selected="$ctrl.model[\''+t+"']\"></mb-footer></div>",bindings:{postId:"@"}}),a.component("mbHeader",{controller:["$timeout","$http","$DragifyWPPopup",function(e,n,i){var o=this;this.state="disabled";var s=JSON.stringify(this.model);this.save=function(r){r.preventDefault(),"ready"==o.state&&(o.state="saving",n({method:"POST",url:a.__config.api+"/page-"+t+"-setting",data:{id:a.__config.post_id,settings:JSON.stringify(o.model)}}).then(function(t){o.state="saved",e(function(){s=JSON.stringify(o.model),o.state="disabled"},1e3)},function(e){i.show({title:"Try it Later",message:"Cannot save data now!"}),o.state="ready"}))},o.getState=function(){return"disabled"==o.state&&JSON.stringify(o.model)!==s&&(o.state="ready"),o.state}}],template:'<div class="dragifywp-smb__header"><h6 class="dragifywp-smb__title">'+i+'</h6><button class="dragifywp-smb__saveBtn dragifywp-ui__btn dragifywp-ui__btn--primary" ng-class="\'dragifywp-smb__saveBtn--\'+$ctrl.getState()" ng-click="$ctrl.save($event)"><span>Saved</span><span>Save</span><span></span><span><i class="fa fa-check" aria-hidden="true"></i></span></button></div>',bindings:{model:"<"}}),a.component("mbFooter",{controller:function(){},template:'<div class="dragifywp-smb__footer"><a class="dragifywp-smb__openCrud" href="'+a.__config.list_url+'" target="_blank">'+i+' List</a><a class="dragifywp-smb__editItem" href="'+a.__config.edit_url+"&post_id="+a.__config.post_id+"&"+t+'_id={{$ctrl.selected}}" target="_blank" ng-disabled="$ctrl.selected == \'none\'">Edit</a></div>',bindings:{selected:"<"}}),a.directive("listSelection",["$http",function(e){return{restrict:"A",scope:{ngModel:"=",ngList:"=",ngDefault:"="},link:function(e,t,n){var i=Date.now(),a=jQuery('<select id="uq-'+i+'" style="width: 100%"></select>');t.append(a),a.select2(),e.$watch("ngList",function(){for(var t="",n=[].concat(e.ngDefault).concat(e.ngList),i=[],o=void 0,s=!1,r=0,d=n.length;r<d;r++){var c=n[r],l={id:c.id,name:c.name};e.ngModel==c.id&&(l.selected=!0,s=!0),c.hasOwnProperty("selected")&&c.selected&&(o=r),i[r]=l}!s&&o&&(i[o].selected=!0);for(var p=0,f=i.length;p<f;p++){var u=i[p],g=u.hasOwnProperty("selected")&&u.selected?'selected="selected"':"";t+='<option value="'+u.id+'" '+g+">"+u.name+"</option>"}a.html(t),a.on("change",function(){e.$apply(function(){e.ngModel=a.val()})})},!0)}}}]),e.element(document).ready(function(){e.bootstrap(document.getElementById("dragifywp-page-header"),["dragifywpPageHeaderApp"])})}(window.angular)},432:function(e,exports){"use strict";!function(e){e.module("dragifywpPopup",[]).factory("$DragifyWPPopup",function(){return{show:function(t){var n=e.element('<div class="dragifywp-bs__fsPopup"><h6 class="dragifywp-bs__fsPopup__title">'+t.title+'</h6><div class="dragifywp-bs__fsPopup__body">'+t.message+'</div><div class="dragifywp-bs__fsPopup__footer"></div></div><div class="dragifywp-bs__fsPopup__backdrop"></div>'),i=n.find(".dragifywp-bs__fsPopup__footer");if(Array.isArray(t.buttons))t.buttons.forEach(function(t){var n=e.element('<button class="dragifywp-ui__btn"></button>');t.hasOwnProperty("text")?n.html(t.text):n.html("Dismiss"),t.hasOwnProperty("class")?n.addClass(t.class):n.addClass("dragifywp-ui__btn--primary"),n.on("click",function(e){e.preventDefault(),"function"==typeof t.callback&&t.callback(),o()}),i.append(n)});else{var a=e.element('<button class="dragifywp-ui__btn dragifywp-ui__btn--primary">Dismiss</button>');i.append(a),a.on("click",function(e){e.preventDefault(),o()})}e.element("body").append(n),"function"==typeof t.onInit&&t.onInit(n);var o=function(){return n.remove(),document.removeEventListener("keydown",s),"function"==typeof t.onClose&&t.onClose(n),!0},s=function(e){27==e.keyCode&&o()};document.addEventListener("keydown",s)}}})}(window.angular)}});